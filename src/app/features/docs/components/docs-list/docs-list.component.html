<app-layout title="Documents" [selectionMode]="multiSelectMode" [isPopup]="false" [isMobile]="appService.isMobile"
    [isTablet]="appService.isTablet" [isDesktop]="appService.isDesktop" (cancelMultiSelect)="cancelMultiSelect()"
    (swipeRight)="enableMobileMultiSelect()">

    <!-- Always visible actions -->
    <ng-container action-always></ng-container>

    <!-- Singular mode actions -->
    <ng-container action-singular>
        <!-- Group By -->
        Group:
        <select [(ngModel)]="groupBy" (change)="loadDocuments()" class="orderby-select"
            [ngClass]="{'mobile': appService.isMobile}">
            <option value="">None</option>
            <option value="type">Type</option>
            <option value="month">Month</option>
            <option value="sender">Sender</option>
            <option value="receiver">Receiver</option>
        </select>

        <!-- Order By -->
        Order: 
        <select [(ngModel)]="orderBy" (change)="loadDocuments()" class="orderby-select"
            [ngClass]="{'mobile': appService.isMobile}">
            <option value="">None</option>
            <option value="createdDate">Date</option>
            <option value="name">Name</option>
            <option value="senderId">Sender</option>
            <option value="receiverId">Receiver</option>
        </select>

        <!-- New File -->
        <button (click)="addNewFile()" title="Create a new folder">
            <i class="fa-solid fa-file-circle-plus"></i>
            <span class="no-wrap" *ngIf="!appService.isMobile">Add Folder</span>
        </button>

        <!-- New Folder -->
        <button (click)="createFolder()" title="Create a new folder">
            <i class="fa fa-folder-plus"></i>
            <span class="no-wrap" *ngIf="!appService.isMobile">Add Folder</span>
        </button>
    </ng-container>

    <!-- Multi-select mode actions -->
    <ng-container action-multiselect>
        <button (click)="deleteSelected()" [disabled]="selectedItems.length === 0" title="Delete selected">
            <i class="fa fa-trash"></i>
            <span class="no-wrap" *ngIf="!appService.isMobile">Delete</span>
        </button>
    </ng-container>

    <!-- Error -->
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>

    <!-- Body -->
    <div class="docs-list" *ngIf="!loading; else loadingSpinner">
        <!-- Add more code for showing relative path -->
        <!-- Add more code for showing list of folders -->
        <app-selectable-row *ngFor="let doc of documents" [title]="doc.name" [description]="doc.type"
            [isSelectable]="true" [selectionMode]="multiSelectMode" [selected]="isSelected(doc)"
            [isDesktop]="appService.isDesktop" [isTablet]="appService.isTablet" [isMobile]="appService.isMobile"
            (selectionChange)="toggleSelect(doc, $event)" (rowClick)="rowClick(doc, $event)">

            <!-- Icon -->
            <i row-icon class="fa" [ngClass]="doc.type === 'folder' ? 'fa-folder' : 'fa-file-alt'"></i>

            <!-- Row actions -->
            <button action-singular class="btn-subtle" (click)="deleteDocument(doc.id, $event)" title="Delete">
                <i class="fa fa-trash"></i>
            </button>
        </app-selectable-row>
    </div>

    <ng-template #loadingSpinner>
        <div class="spinner"><i class="fa fa-spinner fa-spin"></i> Loading documents...</div>
    </ng-template>
</app-layout>